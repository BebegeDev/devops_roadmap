
Структуры — это фундаментальные строительные блоки в Go, которые позволяют создавать пользовательские типы данных, объединяющие связанные данные. Они похожи на классы в других языках программирования, но не поддерживают наследование. Понимание структур крайне важно для организации и управления сложными структурами данных в программах на Go. В этом уроке мы рассмотрим определение структур, их инициализацию, доступ к их полям и встраивание структур в другие структуры.

## Определение структур

Структура — это составной тип данных, который объединяет ноль или более именованных полей, каждое из которых имеет определённый тип. Структуры полезны для представления реальных объектов или концепций, имеющих несколько атрибутов.

### Базовое Определение структуры

Чтобы определить структуру, используйте ключевые слова `type` и `struct`, а затем укажите имя структуры и список полей, заключённый в фигурные скобки. У каждого поля есть имя и тип.

```go
package main

import "fmt"

// Person struct definition
type Person struct {
	FirstName string
	LastName  string
	Age       int
}

func main() {
	// Declaring a variable of type Person
	var person Person

	// Assigning values to the fields
	person.FirstName = "John"
	person.LastName = "Doe"
	person.Age = 30

	// Printing the struct
	fmt.Println(person) // Output: {John Doe 30}
}
```

В этом примере:

- Мы определяем структуру с именем `Person` и тремя полями: `FirstName` (строка), `LastName` (строка) и `Age` (целое число).
- Внутри функции `main` мы объявляем переменную `person` типа `Person`.
- Затем мы присваиваем значения полям структуры `person` с помощью точечной нотации (`.`).
- Наконец, мы выводим структуру `person` на консоль.

### Типы структурных полей

Поля структуры могут иметь любой допустимый тип данных Go, в том числе:

- Основные типы: `int`, `float64`, `string`, `bool`
- Составные типы: массивы, срезы, карты
- Указатели
- Другие структуры

```go
package main

import "fmt"

type Address struct {
	Street  string
	City    string
	ZipCode string
}

type Employee struct {
	ID        int
	FirstName string
	LastName  string
	Address   Address // Embedding the Address struct
}

func main() {
	employee := Employee{
		ID:        123,
		FirstName: "Alice",
		LastName:  "Smith",
		Address: Address{
			Street:  "123 Main St",
			City:    "Anytown",
			ZipCode: "12345",
		},
	}

	fmt.Println(employee) // Output: {123 Alice Smith {123 Main St Anytown 12345}}
}
```

В этом примере:

- Мы определяем структуры `Address` и `Employee` .
- Структура `Employee` содержит поле `Address`, которое является примером встраивания структуры.
- Мы инициализируем переменную `Employee` значениями для всех полей, включая вложенные поля `Address`

### Анонимные поля

Вы можете определить поля структуры без имени. Такие поля называются анонимными. Тип анонимного поля служит его именем. Анонимные поля часто используются для встраивания структур.

```go
package main

import "fmt"

type Name struct {
	FirstName string
	LastName  string
}

type Contact struct {
	Name      // Anonymous field of type Name
	Email     string
	Phone     string
}

func main() {
	contact := Contact{
		Name: Name{
			FirstName: "Bob",
			LastName:  "Johnson",
		},
		Email: "bob.johnson@example.com",
		Phone: "555-1234",
	}

	fmt.Println(contact.FirstName) // Output: Bob (accessing the anonymous field directly)
	fmt.Println(contact.Name.LastName) // Output: Johnson (accessing the anonymous field through the type name)
}
```

В этом примере:

- Структура `Contact` имеет анонимное поле типа `Name`.
- Мы можем получить доступ к полям встроенной структуры `Name` напрямую через структуру `Contact` (например, `contact.FirstName`).
- Мы также можем получить доступ к полям через имя типа (например, `contact.Name.LastName`).

## Инициализирующие структуры

В Go есть несколько способов инициализации структур.

### Использование структурного литерала

Структурный литерал — это способ создания нового значения структуры путём указания значений её полей в фигурных скобках.

```go
package main

import "fmt"

type Point struct {
	X int
	Y int
}

func main() {
	// Initializing a struct using a struct literal
	p := Point{X: 10, Y: 20}

	fmt.Println(p) // Output: {10 20}
}
```

В этом примере:

- Мы инициализируем структуру `Point` с помощью литерала структуры, указывая значения для полей `X` и `Y` .
- Порядок полей в литерале структуры должен совпадать с порядком в определении структуры.
- Вы можете не указывать поля в литерале структуры, и в этом случае они будут инициализированы нулевыми значениями.

```go
package main

import "fmt"

type Rectangle struct {
	Width  int
	Height int
	Color  string
}

func main() {
	// Initializing a struct with some fields omitted
	r := Rectangle{Width: 10, Height: 5} // Color will be initialized to "" (empty string)

	fmt.Println(r) // Output: {10 5 }
}
```

### Используя ключевое слово `new`

Ключевое слово `new` выделяет память для нового значения структуры и возвращает указатель на него. Поля новой структуры инициализируются нулевыми значениями.

```go
package main

import "fmt"

type Circle struct {
	Radius float64
}

func main() {
	// Initializing a struct using the new keyword
	c := new(Circle) // Returns a pointer to a Circle struct

	c.Radius = 2.5 // Accessing the field using the pointer

	fmt.Println(*c) // Output: {2.5} (dereferencing the pointer to access the struct value)
}
```

В этом примере:

- Мы используем ключевое слово `new` для создания новой структуры `Circle` .
- Ключевое слово `new` возвращает указатель на структуру, поэтому для доступа к полям нам нужно использовать точечную нотацию (`.`).
- Мы можем разыменовать указатель с помощью оператора `*`, чтобы получить прямой доступ к значению структуры.

### Использование функции -конструктора

Функция-конструктор — это функция, которая создаёт и инициализирует новое значение структуры. Функции-конструкторы могут быть полезны для выполнения более сложной логики инициализации или для обеспечения соблюдения ограничений в отношении значений полей структуры.

```go
package main

import "fmt"

type Book struct {
	Title  string
	Author string
	Pages  int
}

// Constructor function for the Book struct
func NewBook(title string, author string, pages int) *Book {
	if pages < 0 {
		pages = 0 // Ensure pages is not negative
	}
	return &Book{
		Title:  title,
		Author: author,
		Pages:  pages,
	}
}

func main() {
	// Initializing a struct using a constructor function
	book := NewBook("The Go Programming Language", "Alan Donovan", 384)

	fmt.Println(*book) // Output: {The Go Programming Language Alan Donovan 384}
}
```

В этом примере:

- Мы определяем функцию-конструктор `NewBook`, которая принимает в качестве аргументов заголовок, автора и количество страниц.
- Функция-конструктор выполняет проверку, чтобы убедиться, что количество страниц не отрицательное.
- Функция-конструктор возвращает указатель на новую структуру `Book` .

## Доступ к Полям структуры

Доступ к полям структуры можно получить с помощью точечной нотации (`.`).

```go
package main

import "fmt"

type Product struct {
	ID    int
	Name  string
	Price float64
}

func main() {
	product := Product{
		ID:    1,
		Name:  "Laptop",
		Price: 1200.00,
	}

	// Accessing the fields of the struct
	fmt.Println("Product ID:", product.ID)       // Output: Product ID: 1
	fmt.Println("Product Name:", product.Name)   // Output: Product Name: Laptop
	fmt.Println("Product Price:", product.Price) // Output: Product Price: 1200
}
```

В этом примере:

- Мы обращаемся к полям `ID`, `Name`, и `Price` структуры `product` с помощью точечной нотации.
- Мы выводим значения полей на консоль.

### Доступ к полям встроенных структур

Если структура содержит встроенную структуру, вы можете получить доступ к полям встроенной структуры с помощью точечной нотации, объединив имена полей в цепочку.

```go
package main

import "fmt"

type Dimensions struct {
	Width  float64
	Height float64
}

type Window struct {
	Dimensions // Embedding the Dimensions struct
	Material   string
}

func main() {
	window := Window{
		Dimensions: Dimensions{
			Width:  2.0,
			Height: 1.5,
		},
		Material: "Glass",
	}

	// Accessing the fields of the embedded struct
	fmt.Println("Window Width:", window.Width)   // Output: Window Width: 2
	fmt.Println("Window Height:", window.Height) // Output: Window Height: 1.5
	fmt.Println("Window Material:", window.Material) // Output: Window Material: Glass
}
```

В этом примере:

- Структура `Window` встроена в структуру `Dimensions` .
- Мы можем получить доступ к полям `Width` и `Height` структуры `Dimensions` напрямую через структуру `Window` с помощью точечной нотации.

## Методы построения структуры

В Go можно определять методы для структур. Метод — это функция, связанная с определённым типом. Методы определяются с помощью приёмника, который указывает тип, с которым связан метод.

```go
package main

import (
	"fmt"
)

type Circle struct {
	Radius float64
}

// Method to calculate the area of a circle
func (c Circle) Area() float64 {
	return 3.14159 * c.Radius * c.Radius
}

func main() {
	circle := Circle{Radius: 5.0}

	// Calling the Area method on the circle struct
	area := circle.Area()

	fmt.Println("Area of the circle:", area) // Output: Area of the circle: 78.53975
}
```

В этом примере:

- Мы определяем метод `Area` для структуры `Circle` .
- Приёмник `(c Circle)` указывает на то, что метод связан с типом `Circle` .
- Мы можем вызвать метод `Area` для структуры `Circle` с помощью точечной нотации.

### Приемники Указателей

Методы также могут иметь приёмники-указатели. Приёмник-указатель позволяет методу изменять базовое значение структуры.

```go
package main

import "fmt"

type Counter struct {
	Value int
}

// Method to increment the counter value
func (c *Counter) Increment() {
	c.Value++ // Modifying the struct value using the pointer receiver
}

func main() {
	counter := Counter{Value: 0}

	// Calling the Increment method on the counter struct
	counter.Increment()

	fmt.Println("Counter value:", counter.Value) // Output: Counter value: 1
}
```

В этом примере:

- Мы определяем метод `Increment` в структуре `Counter` с приёмником-указателем `(c *Counter)`.
- Указатель-получатель позволяет методу изменять поле `Value` структуры `Counter` .
- Когда мы вызываем метод `Increment`, поле `Value` увеличивается на единицу.

## Практические примеры и демонстрации

### Пример 1. Представление точки в двумерном пространстве

```go
package main

import "fmt"

type Point struct {
	X int
	Y int
}

func main() {
	p1 := Point{X: 10, Y: 20}
	p2 := Point{X: 30, Y: 40}

	fmt.Println("Point 1:", p1)
	fmt.Println("Point 2:", p2)
}
```

### Пример 2. Представление прямоугольника

```go
package main

import "fmt"

type Rectangle struct {
	Width  int
	Height int
}

func (r Rectangle) Area() int {
	return r.Width * r.Height
}

func main() {
	rect := Rectangle{Width: 10, Height: 5}
	area := rect.Area()

	fmt.Println("Rectangle Area:", area)
}
```

### Пример 3. Представление учащегося с указанием адреса

```go
package main

import "fmt"

type Address struct {
	Street  string
	City    string
	State   string
	ZipCode string
}

type Student struct {
	FirstName string
	LastName  string
	ID        int
	Address   Address
}

func main() {
	student := Student{
		FirstName: "Jane",
		LastName:  "Doe",
		ID:        12345,
		Address: Address{
			Street:  "456 Elm St",
			City:    "Springfield",
			State:   "IL",
			ZipCode: "62704",
		},
	}

	fmt.Println("Student Name:", student.FirstName, student.LastName)
	fmt.Println("Student Address:", student.Address.Street, student.Address.City, student.Address.State, student.Address.ZipCode)
}
```

## Упражнения

1. **Создайте структуру `Car`:** Определите структуру `Car` с полями для `Make`, `Model`, `Year`, и `Color`. Создайте функцию, которая принимает на вход структуру `Car` и выводит всю информацию о машине.
2. **`Rectangle`методы:** Добавьте в структуру `Rectangle` методы для вычисления периметра и проверки, является ли фигура квадратом.
3. **Встроенные структуры:** Создайте структуру `Person` с полями для `Name`, `Age`, и `Address` (используйте структуру `Address` из примеров). Создайте функцию для обновления адреса человека.
4. **Функция-конструктор:** Создайте функцию-конструктор для структуры `Car`, которая будет гарантировать, что `Year` находится в допустимом диапазоне (например, от 1900 года до текущего года).

## Краткие сведения

На этом уроке вы узнали о структурах в Go, в том числе о том, как их определять, инициализировать, получать доступ к их полям и определять для них методы. Структуры — это мощный инструмент для организации сложных структур данных в программах на Go и управления ими. Понимание структур необходимо для создания более сложных приложений и структур данных.


