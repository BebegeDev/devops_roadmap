
Понимание того, что такое знак, показатель степени и мантисса, необходимо для того, чтобы разобраться в том, как числа с плавающей запятой представляются в компьютерных системах и как с ними выполняются операции. Эти три компонента работают вместе, кодируя широкий диапазон числовых значений — от чрезвычайно малых дробей до невероятно больших чисел. Понимание их роли и ограничений крайне важно для написания надёжного и точного программного обеспечения для работы с числами.

## Знаковый Бит

Знаковый бит — это простейший компонент числа с плавающей запятой. Он указывает, является ли число положительным или отрицательным.

### Представительство

- Знаковый бит `0` обычно обозначает положительное число.
- Знаковый бит `1` обычно обозначает отрицательное число.

### Воздействие

Знаковый бит влияет на общее значение числа с плавающей запятой, определяя его полярность. Он не влияет на величину, которая определяется показателем степени и мантиссой.

### Примеры

- `0 10000000 10100000000000000000000` представляет собой положительное число.
- `1 10000000 10100000000000000000000` представляет собой отрицательное число той же величины.

## Показатель степени

Показатель степени определяет масштаб или величину числа с плавающей запятой. По сути, он указывает, насколько нужно сдвинуть десятичную запятую (или двоичную запятую в случае компьютеров) в мантиссе.

### Представительство

Показатель степени обычно хранится в _смещённой_ форме. Это означает, что к фактическому значению показателя степени перед его сохранением добавляется постоянное значение (_смещение_). Это упрощает сравнение чисел с плавающей запятой.

### Расчет смещения

Для чисел с плавающей запятой одинарной точности (float32) смещение обычно составляет 127. Для чисел с плавающей запятой двойной точности (float64) смещение обычно составляет 1023.

### Фактический Расчет показателя степени

Чтобы получить фактическое значение показателя степени, нужно вычесть смещение из сохранённого значения показателя степени.

### Примеры

Давайте рассмотрим число с плавающей запятой одинарной точности (float32):

- Сохранённый показатель степени: `10000001` (двоичный) = 129 (десятичный)
- Предвзятость: 127
- Фактический показатель: 129 – 127 = 2

Это означает, что мантисса будет умножена на 22 = 4.

### Специальные значения экспоненты

Некоторые значения степени зарезервированы для особых случаев, которые будут рассмотрены на следующем уроке. К ним относятся:

- Нулевой показатель степени (все нули): используется для представления нуля и денормализованных чисел.
- Максимальный показатель степени (все единицы): используется для обозначения бесконечности и NaN (не числа).

## Мантисса (также известная как значащая часть или дробная часть)

Мантисса представляет собой значащие цифры числа с плавающей запятой. Она определяет точность числа.

### Представительство

Мантисса обычно хранится в виде дробного значения. В большинстве форматов с плавающей запятой (например, IEEE 754) старший бит мантиссы _неявный_ (также называемый _скрытым_).

### Неявный Ведущий бит

Для нормализованных чисел (наиболее распространённый случай) старший бит считается равным `1`. Это позволяет сохранить один дополнительный бит точности. Сохранённая мантисса представляет собой цифры _после_ этого неявного `1`.

### Пример

Если сохранённая мантисса равна `10100000000000000000000`, то фактическая мантисса равна `1.10100000000000000000000` (в двоичном формате).

### Нормализованные и денормализованные числа

- **Нормализованные числа:** имеют неявный старший бит `1`. Они обеспечивают максимальную точность.
- **Деноминальные числа:** используются для представления чисел, очень близких к нулю. Они имеют неявный старший бит `0` и специальное значение показателя степени (все нули). Деноминальные числа будут рассмотрены на следующем уроке.

### Вычисление значения

Значение, представленное мантиссой, рассчитывается следующим образом:

1 + (мантисса / 2количество бит мантиссы)

Для чисел с плавающей запятой одинарной точности (float32) предусмотрено 23 бита мантиссы. Для чисел с плавающей запятой двойной точности (float64) предусмотрено 52 бита мантиссы.

### Пример

Сохранённая мантисса (одинарная точность): `10100000000000000000000`

Значение = 1 + ( (1 * 2-1) + (0 * 2-2) + (1 * 2-3) ) = 1 + (0,5 + 0 + 0,125) = 1,625

## Собираем всё воедино: вычисление значения с плавающей запятой

Чтобы вычислить значение числа с плавающей запятой, нужно сложить знак, показатель степени и мантиссу.

Значение = (-1) стартовый бит * 2 (показатель степени — смещение) * (1 + мантисса)

### Пример: числа с плавающей запятой (float32)

Возьмём следующее число с плавающей запятой одинарной точности:

`0 10000001 10100000000000000000000`

1. **Знаковый бит:** 0 (положительный)
2. **Показатель степени:** `10000001` (двоичный) = 129 (десятичный)
    - Предвзятость: 127
    - Фактический показатель: 129 – 127 = 2
3. **Мантисса:** `10100000000000000000000`
    - Подразумеваемый старший бит: 1
    - Фактическая мантисса: 1,101 (двоичная) = 1,625 (десятичная)

Значение = (-1)0 * 22 * 1,625 = 1 * 4 * 1,625 = 6,5

### Пример: двойная точность (float64)

Давайте рассмотрим пример с двойной точностью, чтобы проиллюстрировать разницу в размерах экспоненты и мантиссы.

`0 10000000001 1010000000000000000000000000000000000000000000000000`

1. **Знаковый бит:** 0 (положительный)
2. **Степень:** `10000000001` (двоичная) = 1025 (десятичная)
    - Предвзятость: 1023
    - Фактический показатель: 1025 – 1023 = 2
3. **Мантисса:** `1010000000000000000000000000000000000000000000000000`
    - Подразумеваемый старший бит: 1
    - Фактическая мантисса: 1,101 (двоичная) = 1,625 (десятичная)

Значение = (-1)0 * 22 * 1,625 = 1 * 4 * 1,625 = 6,5

Обратите внимание, что, хотя двоичное представление выглядит иначе из-за большего количества разрядов в полях экспоненты и мантиссы, результирующее значение может быть таким же. В числах двойной точности больше битов как в экспоненте, так и в мантиссе, что позволяет использовать более широкий диапазон представимых чисел и обеспечивает более высокую точность.

## Упражнения

1. Преобразуйте следующее число с плавающей запятой одинарной точности в десятичное: `1 01111110 10000000000000000000000`
2. Преобразуйте следующее число с плавающей запятой двойной точности в десятичное: `0 10000000010 0101000000000000000000000000000000000000000000000000`
3. Какое наибольшее положительное число можно представить с помощью числа с плавающей запятой одинарной точности (при условии, что используются только нормализованные числа)? Выразите свой ответ в степенях двойки.
4. Объясните назначение смещения в экспоненциальном представлении. Почему оно используется?
5. Каковы основные различия между представлением мантиссы в нормализованных и денормализованных числах с плавающей запятой?

## Гипотетический Сценарий

Представьте, что вы разрабатываете собственный формат чисел с плавающей запятой для специализированного процессора, используемого в высокопроизводительных графических приложениях. У вас есть ограниченное количество битов для каждого числа с плавающей запятой. Как бы вы распределили биты между знаком, показателем степени и мантиссой, чтобы добиться оптимального баланса между диапазоном и точностью для вашего конкретного приложения? Какие компромиссы вам пришлось бы учитывать? Например, если ваше приложение работает с числами, которые обычно находятся в небольшом диапазоне, но требуют высокой точности, вы можете выделить больше битов для мантиссы и меньше для экспоненты. И наоборот, если вашему приложению нужно представлять очень широкий диапазон значений, но оно может работать с меньшей точностью, вы можете выделить больше битов для экспоненты и меньше для мантиссы.

На этом уроке вы получили базовое представление о знаке, показателе степени и мантиссе чисел с плавающей запятой. Вы узнали, как представлены эти компоненты и как они влияют на общее значение числа с плавающей запятой. На следующем уроке мы подробно рассмотрим форматы чисел с плавающей запятой одинарной (float32) и двойной (float64) точности, изучим их различия и компромиссы. Эти знания будут крайне важны для понимания ограничений арифметики с плавающей запятой и для принятия обоснованных решений о том, какой тип данных использовать в программах на Go.